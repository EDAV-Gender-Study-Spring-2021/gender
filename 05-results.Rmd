# Results

```{r, echo = FALSE, fig.height = 15, fig.width = 15}
#Vincent Figure 1

packages = c('tidyverse', 'dplyr', 'tidyr')

for(p in packages){
  if(!require(p, character.only = T)){
    install.packages(p)
  }
}

library(tidyverse)
library(dplyr)
library(tidyr)

#Load in data

genderStatsCountry <- read.csv("data/Gender_StatsCountry.csv")
genderStatsCountrySeries <- read.csv("data/Gender_StatsCountry-Series.csv")
genderStatsData <- read.csv("data/Gender_StatsData.csv")
genderStatsFootnote <- read.csv("data/Gender_StatsFootNote.csv")
genderStatsSeries <- read.csv("data/Gender_StatsSeries.csv")
genderStatsSeriesTime <- read.csv("data/Gender_StatsSeries-Time.csv")
full_data <- merge(genderStatsSeries, genderStatsData, by.x = "ï..Series.Code", by.y = "Indicator.Code")

countries = c('CAN', 'USA', 'MEX', 'NIC', 'SLV',
              'COL', 'BRA', 'CHL', 'ARG', 'URY',
              'RUS', 'ISL', 'UKR', 'BLR', 'LTU',
              'CHN', 'JPN', 'KOR', 'THA', 'MYS',
              'ZWE', 'TZA', 'NER', 'NGA', 'COG',
              'AUS', 'NZL', 'PNG', 'WSM', 'FJI')

#Processing functions
capFirst <- function(s) {
  paste(toupper(substring(s, 1, 1)), substring(s, 2), sep = "")
}

lowFirst <- function(s) {
  paste(tolower(substring(s, 1, 1)), substring(s, 2), sep = "")
}

#Employment to population ratio by sex
emp_data <- full_data %>% 
  filter(Indicator.Name.x == 'Employment to population ratio, 15+, female (%) (modeled ILO estimate)' |
           Indicator.Name.x == 'Employment to population ratio, 15+, male (%) (modeled ILO estimate)') %>% 
  select(22:24, 75:84) %>% 
  mutate_if(is.numeric, round, 1)
emp_data <- emp_data[emp_data$Country.Code %in% countries ,]
emp_data <- emp_data %>% 
  mutate(emp_data, Mean = rowMeans(select(., starts_with('X')), na.rm = TRUE)) %>% 
  select(1:3, 14) %>% 
  separate(Indicator.Name.y, c('Indicator.Name', 'Age', 'Gender'), sep = ', ') %>% 
  separate(Gender, c('Sex', 'Other'), sep = '^[^\\s]*\\K\\s') %>% 
  select(1:3, 7, 5)
emp_data$Sex <- capFirst(emp_data$Sex)

#Plot Cleveland of Employment to Population Ratio
theme_dotplot <- theme_bw(14) +
  theme(axis.text.y = element_text(size = rel(1.25)),
        axis.ticks.y = element_blank(),
        axis.title.x = element_text(size = rel(1.25)),
        panel.grid.major.x = element_blank(),
        panel.grid.major.y = element_line(size = 1),
        panel.grid.minor.x = element_blank(),
        legend.title = element_blank(),
        plot.title = element_text(hjust = 0.5))

cbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
               "#D55E00", "#0072B2", "#F0E442", "#CC79A7")

#fct_reorder2(`ï..Country.Name`, Sex == "Male", Mean, .desc = FALSE),

ggplot(emp_data, aes(Mean,
                     fct_reorder2(`ï..Country.Name`, Sex == "Male", Mean, .desc = FALSE),
                     color = Sex)) +
  geom_point(size = 3) +
  ggtitle("2010-2019 Average Employment Ratio for each Country by Sex") + 
  ylab("") +
  xlab("% Employed") + 
  scale_colour_manual(values = cbPalette) +
  theme_dotplot
```
The figure above for the average employment ratio by sex between 2010-2019 is ordered in descending order by male employment ratio. The purpose of this ordering is to list countries with high male employment ratios first and visualize whether or not the female employment ratios match up. Out of the 30 countries selected for the study, it is very telling that a lower female employment ratio fairly universal. The actual differences between male/female employment ratio varies drastically by country. From the figure above, it is clear that the issue is much more pronounced in countries like Samoa, Mexico, and Malaysia (among others) as opposed to countries like Canada, Congo, Rep., and Iceland. Whether or not the differences between the ratio of male/female employment varies by continent is explored in another figure below. 
```{r, echo = FALSE, fig.height = 15, fig.width = 15}
#Vincent Figure 2

#Employment in upper/middle management 
mng_data <- full_data %>% 
  filter(Indicator.Name.x == 'Female share of employment in senior and middle management (%)') %>%
  select(22:24, 75:84) %>%
  mutate_if(is.numeric, round, 1)
mng_data <- mng_data[mng_data$Country.Code %in% countries ,]
mng_data <- mng_data %>% 
  mutate(mng_data, Mean = rowMeans(select(., starts_with('X')), na.rm = TRUE)) %>% 
  select(1:3, 14) %>% 
  separate(Indicator.Name.y, c('Sex', 'Indicator.Name'), sep = ' share of ')

male_percentage <- as.data.frame(100 - mng_data$Mean)
male_percentage <- male_percentage %>% 
  rename(Mean = '100 - mng_data$Mean')
male_vals <- cbind(ï..Country.Name = mng_data$ï..Country.Name, 
                    Country.Code = mng_data$Country.Code,
                    'Sex' = 'male',
                    Indicator.Name = mng_data$Indicator.Name,
                    Mean = male_percentage)

mng_data <- rbind(mng_data, male_vals) %>% 
  select(1:2, 4:5, 3)
mng_data$Indicator.Name <- capFirst(mng_data$Indicator.Name)
mng_data$Sex <- capFirst(mng_data$Sex)
mng_data$Indicator.Name <- substr(mng_data$Indicator.Name, 1, 
                                         nchar(mng_data$Indicator.Name) - 4)
mng_data$Mean <- as.numeric(mng_data$Mean)
mng_data[is.na(mng_data)] <- 0

#Plot Cleveland of Management Data
ggplot(mng_data, aes(Mean,
                     fct_reorder2(`ï..Country.Name`, Sex == "Male", Mean, .desc = FALSE),
                     color = Sex)) +
  geom_point(size = 3) +
  ggtitle("2010-2019 Average Proportion of Upper/Middle Management for each Country by Sex") + 
  ylab("") +
  xlab("Proportion") + 
  xlim(10, 90) +
  scale_colour_manual(values = cbPalette) +
  theme_dotplot

```
The figure above for the average proportion of upper/middle management by sex is ordered in descending order by male upper/middle managers. The purpose of this ordering is to list countries with the biggest discrepancy in male/female manager ratio first, which can serve as a signal for gender discrepancies in employment opportunities. The countries on the figure without data points are countries where there is no data related to this area. These missing countries were kept within the figure to signify the fact that the International Labor Organization was unable to obtain any data related to this issue from numerous countries over a 10-year span. Even without 12 of the 30 randomly selected nations from the study, there appears to be a trend that people in upper/middle management are male the vast majority of the time in almost all countries with the exception of Nicaragua (in the sample). An interesting note is that although Papua New Guinea has a near equal proportion of female employment to male employment, upper/middle managers in that country are over 75% male. On the other hand, Nicaragua has a much higher male employment ratio than female employment ratio, but most upper/middle managers are female.
```{r, echo = FALSE, fig.height = 15, fig.width = 15}
#Vincent Figure 3

packages = c('tidyverse', 'dplyr', 'grid', 'gridExtra')

for(p in packages){
  if(!require(p, character.only = T)){
    install.packages(p)
  }
}

library(tidyverse)
library(dplyr)
library(grid)
library(gridExtra)

#Load in data

genderStatsCountry <- read.csv("data/Gender_StatsCountry.csv")
genderStatsCountrySeries <- read.csv("data/Gender_StatsCountry-Series.csv")
genderStatsData <- read.csv("data/Gender_StatsData.csv")
genderStatsFootnote <- read.csv("data/Gender_StatsFootNote.csv")
genderStatsSeries <- read.csv("data/Gender_StatsSeries.csv")
genderStatsSeriesTime <- read.csv("data/Gender_StatsSeries-Time.csv")
full_data <- merge(genderStatsSeries, genderStatsData, by.x = "ï..Series.Code", by.y = "Indicator.Code")

#Full Data of all Countries
data <- full_data %>% 
  filter(Indicator.Name.x == 'Women Business and the Law Index Score (scale 1-100)') %>% 
  select(22:23, 55:84) %>% 
  mutate_if(is.numeric, round, 1)

#NA Region Data
na_countries = c('CAN', 'USA', 'MEX', 'NIC', 'SLV')
na_data <- data[data$Country.Code %in% na_countries ,]

names(na_data) <- substring(names(na_data), 2)
na_data <- na_data %>% 
  rename(Country.Code = 'ountry.Code')

na_data <- na_data %>% 
  pivot_longer(cols = !Country.Code & !..Country.Name, names_to = 'year', values_to = 'index_score')

na_data$region = 'North America'
  
#SA Region Data
sa_countries = c('COL', 'BRA', 'CHL', 'ARG', 'URY')
sa_data <- data[data$Country.Code %in% sa_countries ,]

names(sa_data) <- substring(names(sa_data), 2)
sa_data <- sa_data %>% 
  rename(Country.Code = 'ountry.Code')

sa_data <- sa_data %>% 
  pivot_longer(cols = !Country.Code & !..Country.Name, names_to = 'year', values_to = 'index_score')

sa_data$region = 'South America'

#EU Region Data
eu_countries = c('RUS', 'ISL', 'UKR', 'BLR', 'LTU')
eu_data <- data[data$Country.Code %in% eu_countries ,]

names(eu_data) <- substring(names(eu_data), 2)
eu_data <- eu_data %>% 
  rename(Country.Code = 'ountry.Code')

eu_data <- eu_data %>% 
  pivot_longer(cols = !Country.Code & !..Country.Name, names_to = 'year', values_to = 'index_score')

eu_data$region = 'Europe'

#AS Region Data 
as_countries = c('CHN', 'JPN', 'KOR', 'THA', 'MYS')
as_data <- data[data$Country.Code %in% as_countries ,]

names(as_data) <- substring(names(as_data), 2)
as_data <- as_data %>% 
  rename(Country.Code = 'ountry.Code')

as_data <- as_data %>% 
  pivot_longer(cols = !Country.Code & !..Country.Name, names_to = 'year', values_to = 'index_score')

as_data$region = 'Asia'

#AF Region Data 
af_countries = c('ZWE', 'TZA', 'NER', 'NGA', 'COG')
af_data <- data[data$Country.Code %in% af_countries ,]

names(af_data) <- substring(names(af_data), 2)
af_data <- af_data %>% 
  rename(Country.Code = 'ountry.Code')

af_data <- af_data %>% 
  pivot_longer(cols = !Country.Code & !..Country.Name, names_to = 'year', values_to = 'index_score')

af_data$region = 'Africa'

#OC Region Data
oc_countries = c('AUS', 'NZL', 'PNG', 'WSM', 'FJI')
oc_data <- data[data$Country.Code %in% oc_countries ,]

names(oc_data) <- substring(names(oc_data), 2)
oc_data <- oc_data %>% 
  rename(Country.Code = 'ountry.Code')

oc_data <- oc_data %>% 
  pivot_longer(cols = !Country.Code & !..Country.Name, names_to = 'year', values_to = 'index_score')

oc_data$region = 'Oceania'


#Plotting
full_data <- rbind(na_data, sa_data, eu_data, as_data, af_data, oc_data)

df <- split(full_data, f = full_data$region)

cbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
               "#D55E00", "#0072B2", "#F0E442", "#CC79A7")

na <- ggplot(data = df$'North America', 
             aes(x = year, y = index_score, color = ..Country.Name, group = Country.Code)) + 
  geom_point() +
  geom_line() +
  facet_wrap(~region, ncol = 1) +
  labs(x = 'Year', y = 'Index Score') +
  theme_grey(16) +
  ylim(30, 100) +
  scale_colour_manual(values = cbPalette) +
  theme(axis.text.x = element_text(angle = 80, hjust = 1),
        legend.title = element_blank())

sa <- na %+% df$'South America'
eu <- na %+% df$'Europe'
as <- na %+% df$'Asia'
af <- na %+% df$'Africa'
oc <- na %+% df$'Oceania'

grid.arrange(na,
             sa,
             eu,
             as,
             af,
             oc,
             top = textGrob("Women Business and the Law Index Score by Region Over the Years",
                            gp=gpar(fontsize=20,font=3)))

```
The Women, Business and the Law Score is an index that analyzes laws and regulations that affect women’s economic inclusion in 190 economies. It is composed of eight indicators revolving around women’s interactions with the law as they progress through their careers and make economic decisions. The eight indicators are: mobility, workplace, pay, marriage, parenthood, entrepreneurship, assets, and pension. The index ranges from 1-100 with 100 being the highest score, or equal legal rights with men in measured areas.  
  
The figure above displays the Women, Business and the Law index scores over a 30-year period faceted by continent with 5 countries per continent. The figure indicates a universal trend upwards in the index score over nearly all countries in every continent, although the degree of improvement varies drastically. For example, countries like the Congo, Rep. saw no improvement since 1900 and Papua New Guinea saw very marginal improvements, whereas countries like Brazil and Lithuania saw drastic improvements over the same time frame. It is very uncommon for the index score to go downwards once it has gone up, although it has happened on occasions like in 2004 for Lithuania, 2014 in Ukraine, and 2008 in China. A significant marker for gender inequality in employment is that only 2 of the 30 selected countries ever achieved a score of 100, signifying equal legal rights with men in the measured areas of the index. Although women’s legal rights in the eight indicator areas have improved worldwide since 1990, there are very few countries where equality is achieved as of now. 

```{r, echo = FALSE, fig.height = 15, fig.width = 15}
#Vincent Figure 4

packages = c('tidyverse', 'dplyr', 'grid', 'gridExtra', 'scales', 'patchwork')

for(p in packages){
  if(!require(p, character.only = T)){
    install.packages(p)
  }
}

library(tidyverse)
library(dplyr)
library(grid)
library(gridExtra)
library(scales)
library(patchwork)

#Load in data


data = read.csv("data/Gender_StatsData.csv",header = TRUE,encoding="UTF-8")
colnames(data)=c("Country","Code","Indicator_details","Indicator",as.character(1960:2020))

Code = c("CAN","USA","MEX","NIC","SLV","COL","BRA","CHL","ARG","URY","RUS","ISL","UKR","BLR","LTU","CHN","JPN","KOR","THA","MYS","COG","ZWE","TZA","NER","NGA",'AUS','NZL','PNG','WSM','FJI')
Continent = rep(c("North America","South America","Europe","Asia","Africa","Oceania"),rep(5,6))
data_continent = data.frame(cbind(Code,Continent))

data_GDP = data[data$Code%in%Code & data$Indicator== "NY.GDP.PCAP.CD",c(2,64)]
colnames(data_GDP) = c("Code","GDP")
data_GDP$GDP = log(data_GDP$GDP)


data_incom = read.csv("data/Gender_StatsCountry.csv",header = TRUE,encoding="UTF-8")[,c(1,9)]
colnames(data_incom) = c("Code","Income")
data_INC = data_incom[data_incom$Code%in%Code,]
data_EMP = data[data$Code%in%Code & data$Indicator == "SL.TLF.CACT.FM.ZS",c(2,55:64)]
colnames(data_EMP) = c("Code",as.character(c(2010:2019)))
data_EMP = data_EMP%>%pivot_longer(cols = starts_with("1") | starts_with("2"),names_to = "Year",values_to = "ratio")
data_EMP = data_EMP%>% group_by(Code) %>% summarise(Mean = sum(ratio)/n())
data_EMP_AN = left_join(left_join(left_join(data_EMP,data_GDP,by=c("Code")),data_continent,by=c("Code")),data_INC,by = c("Code"))

cbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
               "#0072B2", "#CC79A7")

ggplot(data_EMP_AN,aes(y=Mean,x=GDP, color = Continent))+
  geom_point(size = 3) +
  ggtitle('2010-2019 Average Female/Male Labor Force Participation Rate vs. Log-Scale GDP') +
  scale_colour_manual(values = cbPalette) +
  scale_x_continuous("Log(GDP)") +
  scale_y_continuous("Average of Female/Male Labor Force Participation Rate") +
  theme_grey(16) +
  theme(legend.title = element_blank(),
        plot.title = element_text(hjust = 0.5))

```
The figure above displays the ratio of female to male employment ratio vs. GDP on a log scale for each country color coded by continent. There appears to no correlation overall between a country’s female/male labor force participation rate to the country’s GDP as the data points are scattered throughout as opposed to group along a linear line. However, when looking at individual continents separately, female/male labor force participation rate does seem correlated with GDP in continents like Europe, Africa, and North America (trend is not really observable for Asia, Oceania, and South America). This suggests that the correlation between female/male employment ratio may have a lot to do with geographical location of the country, and depending on the location, the ratio may be correlated with GDP.